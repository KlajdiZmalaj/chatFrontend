(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{103:function(e,t,a){},151:function(e,t,a){e.exports=a(264)},213:function(e,t,a){},216:function(e,t,a){},264:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(15),c=a.n(r),i=a(31),s=a(5),l=a(45),u=Object(l.createActions)({setUnauthorization:[],getLogin:["username","password"],setLoginData:["loginData"],checkToken:["token"],submitMsg:["id","text","token"]}),d=(u.Types,u.Creators),m={loginData:JSON.parse(localStorage.getItem("loginData")||"{}")||{}},v=Object(l.createReducer)(m,{SET_LOGIN_DATA:function(e,t){var a=t.loginData;return Object(s.a)(Object(s.a)({},e),{},{loginData:a})},SET_UNAUTHORIZATION:function(){return localStorage.setItem("loginData","{}"),Object(s.a)(Object(s.a)({},m),{},{loginData:{}})}}),p=Object(l.createActions)({setRoomData:["roomData"],getRoomData:["id"],getRooms:[],setRooms:["rooms"],setActiveRoom:["activeRoom"],updateRoomMessages:["data"],getRegister:["username","password","redirectAndClear"]}),f=(p.Types,p.Creators),g=Object(l.createReducer)({roomData:{},rooms:[],activeRoom:""},{SET_ROOM_DATA:function(e,t){var a=t.roomData;return Object(s.a)(Object(s.a)({},e),{},{roomData:a})},SET_ROOMS:function(e,t){var a=t.rooms;return Object(s.a)(Object(s.a)({},e),{},{rooms:a})},SET_ACTIVE_ROOM:function(e,t){var a=t.activeRoom;return Object(s.a)(Object(s.a)({},e),{},{activeRoom:a})}}),h=a(144),b=a(13),E=a(44),O=function(){return o.a.createElement("div",{className:"login-left"})},w=(a(103),Object(i.b)(null,d)((function(e){var t=e.getLogin,a=Object(n.useState)({}),r=Object(E.a)(a,2),c=r[0],i=r[1];return console.log("ca ka",c),o.a.createElement(o.a.Fragment,null,o.a.createElement(O,null),o.a.createElement("form",{className:"loginForm"},o.a.createElement("i",{className:"fal fa-user-circle","aria-hidden":"true"})," ",o.a.createElement("div",null,o.a.createElement("i",{className:"fal fa-user","aria-hidden":"true"}),o.a.createElement("input",{placeholder:"Username",type:"text",onChange:function(e){i(Object(s.a)(Object(s.a)({},c),{},{username:e.target.value}))}})),o.a.createElement("div",null,o.a.createElement("i",{className:"fal fa-lock","aria-hidden":"true"}),o.a.createElement("input",{placeholder:"Passcode",type:"text",onChange:function(e){i(Object(s.a)(Object(s.a)({},c),{},{password:e.target.value}))}})),o.a.createElement("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),t(c.username,c.password)}},"Loggin"),o.a.createElement("p",null,"Dont have account?"," ",o.a.createElement("span",{onClick:function(){window.location.hash="register"}},"Register"))))}))),j=(a(213),a(268)),k=a(128),R=a.n(k),_=Object(i.b)((function(e){var t=e.auth.loginData,a=e.main;return{loginData:t,rooms:a.rooms,activeRoom:a.activeRoom,roomData:a.roomData}}),Object(s.a)(Object(s.a)({},f),d))((function(e){var t,a=e.loginData,r=void 0===a?{}:a,c=e.setUnauthorization,i=e.getRooms,s=e.rooms,l=e.setActiveRoom,u=e.activeRoom,d=e.getRoomData,m=e.roomData,v=e.setRoomData,p=e.checkToken,f=e.submitMsg;Object(n.useEffect)((function(){i()}),[]),Object(n.useEffect)((function(){var e=document.querySelector(".msg:last-child");e&&setTimeout((function(){e.scrollIntoView({behavior:"smooth"})}),300)}),[null===m||void 0===m?void 0:m.name]);var g=Object(n.useState)(""),h=Object(E.a)(g,2),b=h[0],O=h[1];return o.a.createElement("div",{className:"homePage"},o.a.createElement("div",{className:"homePage--left"},s.map((function(e){return o.a.createElement("div",{key:e._id,"room-id":e._id,className:"room".concat(u===e._id?" active":""),onClick:function(){l(e._id),d(e._id),u&&window.socket.emit("unsubscribe",u),window.socket.emit("subscribe",e._id)}},o.a.createElement("img",{src:null===e||void 0===e?void 0:e.image,alt:""})," ",o.a.createElement("span",null,null===e||void 0===e?void 0:e.name),u===e._id?o.a.createElement("i",{className:"fal fa-sign-out",onClick:function(e){e.preventDefault(),e.stopPropagation(),l(""),v({})}}):null)}))),o.a.createElement("div",{className:"homePage--right"},o.a.createElement("div",{className:"homePage--right__top"},o.a.createElement("p",null,"Welcome ",o.a.createElement("span",null,r.username)," "),o.a.createElement("p",{id:"roomName"},(null===m||void 0===m?void 0:m.name)||"Select a Room"),o.a.createElement("button",{onClick:function(){p(r.token)}},o.a.createElement("i",{className:"fal fa-badge-check"})," Check token"),o.a.createElement("button",{onClick:function(){c()}},o.a.createElement("i",{className:"fal fa-sign-out"})," Log OUT")),o.a.createElement("div",{className:"homePage--right__cover"},o.a.createElement("div",{style:{backgroundImage:"url(".concat(null===m||void 0===m?void 0:m.image,")")}},o.a.createElement("div",null),o.a.createElement("img",{src:null===m||void 0===m?void 0:m.image,alt:""}))),o.a.createElement("div",{className:"homePage--right__messages"},o.a.createElement("div",{id:"msgWrapper",className:"msg-wrapper"},(null===m||void 0===m?void 0:m.messages)?null===m||void 0===m||null===(t=m.messages)||void 0===t?void 0:t.sort((function(e,t){return e-t})).map((function(e){var t,a,n;return o.a.createElement(j.a,{key:e._id,placement:(null===r||void 0===r?void 0:r.username)===(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.username)?"topRight":"topLeft",title:"Sent at ".concat(R()(e.date).format("MMMM Do YYYY, h:mm:ss a"))},o.a.createElement("div",{className:"msg".concat((null===r||void 0===r?void 0:r.username)===(null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.username)?" me":"")},o.a.createElement("div",{className:"userMsg"},null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.username),o.a.createElement("div",{className:"text"},null===e||void 0===e?void 0:e.text)))})):o.a.createElement("span",null,u?"No messages yet in this room. Start typing your first message.":"No room selected.")),o.a.createElement("div",{className:u?"inputbar":"disable inputbar"},o.a.createElement("i",{className:"far fa-grin-stars"}),o.a.createElement("input",{type:"text",value:b,onKeyPress:function(e){13==e.charCode&&(O(""),f(m._id,b,null===r||void 0===r?void 0:r.token))},onChange:function(e){O(e.target.value)}}),o.a.createElement("i",{className:"fad fa-paper-plane",onClick:function(){O(""),f(m._id,b,null===r||void 0===r?void 0:r.token)}})))))})),D=a(266),N=Object(i.b)(null,f)((function(e){var t=e.getRegister,a=Object(n.useState)({}),r=Object(E.a)(a,2),c=r[0],i=r[1],l=function(){i({username:"",password:"",password2:""})};return o.a.createElement(o.a.Fragment,null,o.a.createElement(O,null),o.a.createElement("form",{className:"loginForm"},o.a.createElement("i",{className:"fal fa-user-plus","aria-hidden":"true"}),o.a.createElement("div",null,o.a.createElement("i",{className:"fal fa-user","aria-hidden":"true"}),o.a.createElement("input",{type:"text",placeholder:"UserName",value:c.username,onChange:function(e){i(Object(s.a)(Object(s.a)({},c),{},{username:e.target.value}))}})),o.a.createElement("div",null,o.a.createElement("i",{className:"fal fa-lock","aria-hidden":"true"}),o.a.createElement("input",{placeholder:"Passcode",type:"text",value:c.password,onChange:function(e){i(Object(s.a)(Object(s.a)({},c),{},{password:e.target.value}))}})),o.a.createElement("div",null,o.a.createElement("i",{className:"fal fa-lock","aria-hidden":"true"}),o.a.createElement("input",{placeholder:"Repeat Passcode",type:"text",value:c.password2,onChange:function(e){i(Object(s.a)(Object(s.a)({},c),{},{password2:e.target.value}))}})),o.a.createElement("button",{onClick:function(e){e.preventDefault(),e.stopPropagation(),c.username&&c.password&&c.password===c.password2?t(c.username,c.password,l):D.a.error({description:"Passwords are not the same",placement:window.innerWidth<=1024?"topRight":"bottomRight",duration:4})}},"Register"),o.a.createElement("p",null,"Already Signed Up?",o.a.createElement("span",{onClick:function(){window.location.hash="login"}},"Login"))))})),S=function(){return o.a.createElement("div",{"data-route":"login"},o.a.createElement(w,null))},x=function(){return o.a.createElement("div",{"data-route":"home"},o.a.createElement(_,null))},T=function(){return o.a.createElement("div",{"data-route":"login"},o.a.createElement(N,null))},y=(a(215),a(216),a(143)),A=window.location.href.match(/127|192|localhost/g),C=A?"http://192.168.5.220:5000/api":"https://chat-al.herokuapp.com/api/",I=function(e,t){var a,n,o,r;return(null===e||void 0===e||null===(a=e.response)||void 0===a?void 0:a.status)===parseInt(t)||(null===(n=e.error)||void 0===n||null===(o=n.response)||void 0===o?void 0:o.status)===parseInt(t)||(null===e||void 0===e||null===(r=e.response)||void 0===r?void 0:r.status)===parseInt(t)},M=function(e){if(I(e,401))window.store.dispatch({type:"SET_UNAUTHORIZATION"});else if("Network Error"===(null===e||void 0===e?void 0:e.message));else if(I(e,445));else if(I(e,440));else if(I(e,429));else if(I(e,403));else{var t,a,n,o;D.a.error({message:(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"error Message",description:(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.errors)&&Object.values(e.response.data.errors),placement:window.innerWidth<=1024?"topRight":"bottomRight",duration:4})}return Promise.reject(e)},P=Object(i.b)((function(e){return{loginData:e.auth.loginData}}),Object(s.a)(Object(s.a)({},d),f))((function(e){var t=e.loginData,a=void 0===t?{}:t;return Object(n.useEffect)((function(){!function(){var e=Object(y.io)(A?"http://192.168.5.220:5000":"https://chat-al.herokuapp.com:5000");window.socket=e,e.on("connect",(function(){console.log("socket connected")})),e.on("FromAPI",(function(e){console.log("FromAPI",e)})),e.on("chat_msg",(function(e){console.log("chat_msg",e),window.store.dispatch({type:"UPDATE_ROOM_MESSAGES",data:e}),document.querySelector(".msg:last-child").scrollIntoView({behavior:"smooth"})})),e.on("message",(function(e){console.log("message",e)}))}()}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null),o.a.createElement(h.a,null,o.a.createElement(b.d,null,o.a.createElement(b.b,{exact:!0,path:"/"},a.token?o.a.createElement(b.a,{to:"/home"}):o.a.createElement(b.a,{to:"/login"})),o.a.createElement(b.b,{path:"/login",render:function(){return a.token?o.a.createElement(b.a,{to:"/home"}):o.a.createElement(S,null)}}),o.a.createElement(b.b,{path:"/register",render:function(){return a.token?o.a.createElement(b.a,{to:"/home"}):o.a.createElement(T,null)}}),o.a.createElement(b.b,{path:"/home"},a.token?o.a.createElement(x,null):o.a.createElement(b.a,{to:"/login"})))))})),U=a(34),L=a(150),F=a(10),G=a.n(F),W=a(12),J=a(72),V=a(73),q=a.n(V),X=q.a.create({baseURL:C});X.interceptors.request.use(function(){var e=Object(J.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.headers={Accept:"application/json"},e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){Promise.reject(e)})),X.interceptors.response.use((function(e){return e}),(function(e){return M(e)}));var Y=function(e,t){return X.get("/login",{params:{username:e,password:t}}).catch((function(e){return{error:e}}))},B=function(e){return X.get("/check",{params:{token:e}}).catch((function(e){return{error:e}}))},H=function(e,t,a){return X.post("/sendMsg",{roomId:e,text:t,token:a}).catch((function(e){return{error:e}}))},K=G.a.mark($),z=G.a.mark(Q),Z=G.a.mark(ee);function $(e){var t,a,n,o;return G.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.username,a=e.password,r.next=3,Object(W.b)(Y,t,a);case 3:if(!(n=r.sent)){r.next=8;break}return r.next=7,Object(W.c)(d.setLoginData(n.data));case 7:(null===(o=n.data)||void 0===o?void 0:o.token)&&localStorage.setItem("loginData",JSON.stringify(n.data));case 8:case"end":return r.stop()}}),K)}function Q(e){var t,a;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.token,n.next=3,Object(W.b)(B,t);case 3:(null===(a=n.sent)||void 0===a?void 0:a.data)&&D.a.success({description:JSON.stringify(null===a||void 0===a?void 0:a.data),placement:window.innerWidth<=1024?"topRight":"bottomRight",duration:4});case 5:case"end":return n.stop()}}),z)}function ee(e){var t,a,n;return G.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.id,a=e.text,n=e.token,o.next=3,Object(W.b)(H,t,a,n);case 3:o.sent.data;case 5:case"end":return o.stop()}}),Z)}var te=a(147),ae=a(145),ne=q.a.create({baseURL:C});ne.interceptors.request.use(function(){var e=Object(J.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.headers={Accept:"application/json"},e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){Promise.reject(e)})),ne.interceptors.response.use((function(e){return e}),(function(e){return M(e)}));var oe=function(e,t){return ne.post("/register",{username:e,password:t}).catch((function(e){return{error:e}}))},re=function(){return ne.get("/getRooms").catch((function(e){return{error:e}}))},ce=function(e){return ne.get("/getRoomData/".concat(e)).catch((function(e){return{error:e}}))},ie=G.a.mark(de),se=G.a.mark(me),le=G.a.mark(ve),ue=G.a.mark(pe);function de(e){var t,a,n,o,r,c,i,s,l,u,m,v,p,f,g,h;return G.a.wrap((function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.username,a=e.password,n=e.redirectAndClear,b.next=3,Object(W.b)(oe,t,a);case 3:if(!(o=b.sent).data){b.next=12;break}if(n(),D.a.success({description:null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.message,placement:window.innerWidth<=1024?"topRight":"bottomRight",duration:4}),!(null===(c=o.data)||void 0===c?void 0:c.token)){b.next=12;break}return b.next=10,Object(W.c)(d.setLoginData({token:null===o||void 0===o||null===(i=o.data)||void 0===i?void 0:i.token,username:null===o||void 0===o||null===(s=o.data)||void 0===s||null===(l=s.userFound)||void 0===l?void 0:l.username,id:null===o||void 0===o||null===(u=o.data)||void 0===u||null===(m=u.userFound)||void 0===m?void 0:m._id}));case 10:localStorage.setItem("loginData",JSON.stringify({token:null===o||void 0===o||null===(v=o.data)||void 0===v?void 0:v.token,username:null===o||void 0===o||null===(p=o.data)||void 0===p||null===(f=p.userFound)||void 0===f?void 0:f.username,id:null===o||void 0===o||null===(g=o.data)||void 0===g||null===(h=g.userFound)||void 0===h?void 0:h._id})),window.location.hash="home";case 12:case"end":return b.stop()}}),ie)}function me(e){var t,a;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Object(ae.a)(e),n.next=3,Object(W.b)(re);case 3:if(!(t=n.sent).data){n.next=7;break}return n.next=7,Object(W.c)(f.setRooms(null===(a=t.data)||void 0===a?void 0:a.data));case 7:case"end":return n.stop()}}),se)}function ve(e){var t,a,n;return G.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.id,o.next=3,Object(W.b)(ce,t);case 3:if(!(a=o.sent).data){o.next=7;break}return o.next=7,Object(W.c)(f.setRoomData(null===(n=a.data)||void 0===n?void 0:n.data));case 7:case"end":return o.stop()}}),le)}function pe(e){var t,a;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.data,n.next=3,Object(W.d)((function(e){return e.main.roomData}));case 3:return a=n.sent,a=Object(s.a)(Object(s.a)({},a),{},{messages:[].concat(Object(te.a)(a.messages),[t])}),n.next=7,Object(W.c)(f.setRoomData(a));case 7:case"end":return n.stop()}}),ue)}var fe=G.a.mark(ge);function ge(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(W.a)([Object(W.e)("GET_LOGIN",$),Object(W.e)("CHECK_TOKEN",Q),Object(W.e)("SUBMIT_MSG",ee)].concat([Object(W.e)("GET_REGISTER",de),Object(W.e)("GET_ROOMS",me),Object(W.e)("GET_ROOM_DATA",ve),Object(W.e)("UPDATE_ROOM_MESSAGES",pe)]));case 2:case"end":return e.stop()}}),fe)}var he=Object(U.c)({auth:v,main:g});var be=function(){var e=Object(L.a)(),t=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):U.d)(Object(U.a)(e));return Object(s.a)(Object(s.a)({},Object(U.e)(he,t)),{},{runSaga:e.run})}();be.runSaga(ge),window.store=be;var Ee=function(){return o.a.createElement(i.a,{store:be},o.a.createElement(P,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[151,1,2]]]);
//# sourceMappingURL=main.1c8f5159.chunk.js.map